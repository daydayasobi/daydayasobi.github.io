<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>TEngine框架学习 基于TEngine框架实现的塔防Demo</title>
    <link href="/2025/07/11/TEngineLean2/"/>
    <url>/2025/07/11/TEngineLean2/</url>
    
    <content type="html"><![CDATA[<h2 id="项目链接"><a href="#项目链接" class="headerlink" title="项目链接"></a>项目链接</h2><p>GitHub: <a href="https://github.com/DrFlower/TowerDefense-GameFramework-Demo">基于TEngine框架实现的塔防Demo</a></p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>该项目是在<a href="https://github.com/Alex-Rachel/TEngine">TEngine框架</a>的基础上，使用Unity开源资源，大量参考开源项目“<a href="https://github.com/DrFlower/TowerDefense-GameFramework-Demo">基于Unity开源框架GameFramewrk实现的一款塔防游戏Demo</a>”制作的一款塔防Demo。</p><p>TE框架是一款非常优秀的Unity开源框架，目前相关的文档还不够完善，Demo也比较少。所以本着学习TE框架的心态，效仿花桑大佬复刻了一个基于TE框架的塔防Demo，同时记录一下自己在使用TE框架心得和遇到的坑，希望能给后来人一些经验和启发。</p><h2 id="版本信息"><a href="#版本信息" class="headerlink" title="版本信息"></a>版本信息</h2><ul><li><p>Unity: 2022.3.10f1</p></li><li><p>TEngine: 2025.5.20</p></li><li><p>YooAsset: 2.3.8</p></li><li><p>HybridCLR: 7.6.0</p></li><li><p>Tower Defense Template: 1.4.1</p></li></ul><h2 id="项目内容"><a href="#项目内容" class="headerlink" title="项目内容"></a>项目内容</h2><p>本项目测试了了Windows打包运行和热更新，运用到了TE框架里大部分的模块，包括资源模块、事件模块、UI模块、流程模块、FSM模块、多语言模块、内存池和对象池模块。使用了Luban配置表工具、YooAsset打包工具和HybridCLR热更新工具。后续可能会根据该项目出一些TE框架的教程，到时候会一并贴出。</p><h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h3><p></pre></p><p>├─ AssetArt                    &#x2F;&#x2F; 美术产出物（非运行时直接引用）<br>│  └─ Atlas                    &#x2F;&#x2F; 图集原始文件（TexturePacker 等导出的 .tps &#x2F; .png）<br>├─ AssetRaw                    &#x2F;&#x2F; 原始资源（策划&#x2F;美术直接维护）<br>│  ├─ Actor                    &#x2F;&#x2F; 角色&#x2F;机关&#x2F;塔等实体的预制体<br>│  ├─ Audios                   &#x2F;&#x2F; 音频<br>│  ├─ Configs                  &#x2F;&#x2F; 策划配置<br>│  │  ├─ bytes                 &#x2F;&#x2F;   Luban生成的二进制表<br>│  │  └─ Localization          &#x2F;&#x2F;   I2 Localization 用的多语言CSV<br>│  ├─ DLL                      &#x2F;&#x2F; 第三方托管 DLL（LitJson、Luban.Runtime 等）<br>│  ├─ Effects                  &#x2F;&#x2F; 特效源文件（.prefab &#x2F; .fbx &#x2F; .shadergraph）<br>│  ├─ Fonts                    &#x2F;&#x2F; 字体<br>│  ├─ Materials                &#x2F;&#x2F; 材质球（sharedMaterial）<br>│  ├─ Res                      &#x2F;&#x2F; 运行时真正打进包体的资源（Animations、Models、Particles、Scenes…）<br>│  ├─ Scenes                   &#x2F;&#x2F; 主工程 Scenes（实际 Build 用）<br>│  ├─ Shaders                  &#x2F;&#x2F; 着色器源文件<br>│  ├─ UI                       &#x2F;&#x2F; UI Prefab（运行时动态加载）<br>│  └─ UIRaw                    &#x2F;&#x2F; UI 美术源文件（PSD、切图、未打图集）<br>├─ Editor                      &#x2F;&#x2F; 纯编辑器扩展脚本<br>├─ GameScripts                 &#x2F;&#x2F; 业务代码（热更 + 原生）<br>│  ├─ HotFix                  &#x2F;&#x2F; 游戏热更程序集目录<br>│  │  ├─ GameLogic            &#x2F;&#x2F;   游戏业务逻辑程序集<br>│  │  └─ GameProto            &#x2F;&#x2F;   游戏配置协议程序集<br>│  └─ Procedure               &#x2F;&#x2F;   原生程序集里的流程入口<br>├─ HybridCLRGenerate           &#x2F;&#x2F; HybridCLR 生成 Wrappers &amp; AOT dll 的临时目录<br>├─ Launcher                    &#x2F;&#x2F; 原生启动场景<br>├─ MobileDependencyResolver    &#x2F;&#x2F; Google Play Resolver 插件<br>├─ Scenes                      &#x2F;&#x2F; 真正 Build Settings 里挂的入口场景<br>├─ StreamingAssets             &#x2F;&#x2F; 随包体拷贝的只读资源<br>├─ TEngine                     &#x2F;&#x2F; TEngine 框架本体</p><p></pre></p><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202507181132652.png" alt="image-20250718113248518"></p><p>工程里已经包含了配置表和Luban的依赖，如上图所示点击<code>Gen_Bin-Custom.bat</code>即可生成配置文件和代码到工程中。</p><h3 id="待完善的地方"><a href="#待完善的地方" class="headerlink" title="待完善的地方"></a>待完善的地方</h3><ul><li>实体模块要更换，在写这个项目的时候TE框架还没有更新实体模块，所以照着GF框架自己添加了一个，仅供参考，后续会换成TE里的实体模块。</li><li>存档模块需要完善，现在用的存档模块很简陋，后续会修改。</li><li>内存池引用池运用存在问题，现在的用法比较除暴，对象池用的还是TE打飞机框架中的脚本，后续会优化一下。</li><li>资源分包、按关卡下载的功能还没有实现，后续会添加。</li><li>没有运用到服务器和网络功能，后续会考虑添加。</li></ul><h2 id="相关引用"><a href="#相关引用" class="headerlink" title="相关引用"></a>相关引用</h2><ul><li><a href="https://github.com/DrFlower/TowerDefense-GameFramework-Demo">基于Unity开源框架GameFramewrk实现的一款塔防游戏Demo</a></li><li><a href="https://gitee.com/tuzhong_w/tower-defense-tengine-demo">用te框架仿照gf的框架的重写</a></li><li><a href="https://github.com/Alex-Rachel/TEngine">TEngine框架</a></li><li><a href="https://github.com/focus-creative-games/luban">Luban</a></li><li><a href="https://blog.meo39.com/2025/06/09/lubanLean1/">Luban配置教程和按文件加载优化</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Unity</tag>
      
      <tag>TEngine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【Unity】Luban配置教程和按文件加载优化</title>
    <link href="/2025/06/09/lubanLean1/"/>
    <url>/2025/06/09/lubanLean1/</url>
    
    <content type="html"><![CDATA[<p>Github地址：<a href="https://github.com/focus-creative-games/luban">https://github.com/focus-creative-games/luban</a></p><p>官方文档：<a href="https://luban.doc.code-philosophy.com/">https://luban.doc.code-philosophy.com/</a></p><p>官方示例工程：<a href="https://github.com/focus-creative-games/luban_examples">https://github.com/focus-creative-games/luban_examples</a></p><p>参考文章：<a href="https://blog.csdn.net/wankcn/article/details/127883528?spm=1001.2014.3001.5502">Unity导表工具Luban插件的数据加载原理与优化</a></p><h3 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h3><p>​luban是一个强大、易用、优雅、稳定的游戏配置解决方案，虽然luban配置起来比较麻烦，但是博主依旧愿意向大部分人推荐，这里列举几个自己喜欢的点：</p><ul><li><p><strong>强大的数据校验功能</strong>，可以有效避免策划或者程序瞎搞配置表弄出的bug。</p></li><li><p><strong>支持使用OOP类型继承</strong>，极大的丰富了表格的使用方式。</p></li><li><p>统一了工作流，提高了策划和程序的效率。</p></li><li><p>当使用C#+bytes时，<strong>文件占用小、加载速度快、几乎无GC</strong>。</p><p>其实除了上面讲的，luban还有很多优势，这里就不一一赘述了。本篇博客主要讲了作为程序在使用luban时的配置和优化，后面或许会再加一篇表构建和运动的帖子。</p></li></ul><h3 id="二、Luban配置和基本使用教程"><a href="#二、Luban配置和基本使用教程" class="headerlink" title="二、Luban配置和基本使用教程"></a>二、Luban配置和基本使用教程</h3><ol><li><p>配置环境</p><p>首先，安装<a href="https://dotnet.microsoft.com/download/dotnet/8.0">dotnet sdk 8.0</a>或更高版本sdk。</p><p>然后，下载<a href="https://gitee.com/focus-creative-games/luban_examples">luban_examples项目</a>。</p><p>最后，unity AssetManager使用Git方式安装luban插件：<a href="https://github.com/focus-creative-games/luban_unity.git">https://github.com/focus-creative-games/luban_unity.git</a></p></li><li><p>配置luban</p><p>打开luban的实列工程文件夹，这里讲讲四个主要文件夹</p><ul><li>DataTables：一个复杂的配置表文件</li><li>MiniTemplate：一个小的示例，点击<code>gen.bat</code>后快速生成一个json配置表</li><li>Projects：一大堆各式各样的模板示例</li><li>Tools：编译好的luban的dll和模板</li></ul><p>因为博主使用的是C#+bytes的方式，这里以Projects下的Csharp_Unity_LazyLoad_bin为基础讲解，这里贴出<code>gen.bat</code>的解析，代码和注释如下：</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> WORKSPACE=..\..</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> LUBAN_DLL=<span class="variable">%WORKSPACE%</span>\Tools\Luban\Luban.dll</span><br><span class="line">## LUBAN_DLL是Luban工具Dll的位置</span><br><span class="line"><span class="built_in">set</span> CONF_ROOT=<span class="variable">%WORKSPACE%</span>\DataTables</span><br><span class="line">## CONF_ROOT是表所有的位置</span><br><span class="line"></span><br><span class="line">dotnet <span class="variable">%LUBAN_DLL%</span> ^</span><br><span class="line">    -t client ^</span><br><span class="line">    -c cs-lazyload-bin ^</span><br><span class="line">    -d bin bin-offsetlength  ^</span><br><span class="line">    --conf <span class="variable">%CONF_ROOT%</span>\luban.conf ^</span><br><span class="line">    -x outputCodeDir=Unity/Assets/Gen ^</span><br><span class="line">    -x bin.outputDataDir=Unity/Assets/StreamingAssets/Config/bin ^</span><br><span class="line">    -x bin-offsetlength.outputDataDir=Unity/Assets/StreamingAssets/Config/offset ^</span><br><span class="line">    -x pathValidator.rootDir=<span class="variable">%WORKSPACE%</span>\Projects\Csharp_Unity_bin ^</span><br><span class="line">    -x l10n.textProviderFile=*@<span class="variable">%WORKSPACE%</span>\DataTables\Datas\l10n\texts.json</span><br><span class="line"></span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure><p><code>LUBAN_DLL</code>是luban工具dll的位置</p><p><code>CONF_ROOT</code>是表所有的位置</p><p><code>outputCodeDir</code>是生成C#代码的位置，为了避免误删，一定要是空文件夹。</p><p><code>outputDataDir</code>是bytes文件的输出目录为</p><p><code>pathValidator</code>是设置路径验证器的根目录</p><p>双击<code>gen.bat</code>后，如果一切正常会以<em>bey~</em>结束，表示配置成功。并在当前<code>Unity\Assets</code>里生成对应的代码和bytes文件。</p></li><li><p>配置Unity</p><p>如果unity已经安装了上面的插件，实例工程中有两个脚本需要关注<code>Main.cs</code>和<code>ConfigManager.cs</code>，main里调用的bytes文件加载和一堆测试用例，这里不做赘述。<code>ConfigManager.cs</code>脚本才是核心的管理类。以下是官方的提供的实例代码：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> cfg;</span><br><span class="line"><span class="keyword">using</span> Luban;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ConfigManager</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Tables tables;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] BUFFER = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">1024</span> * <span class="number">1024</span> * <span class="number">10</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Dictionary&lt;<span class="built_in">string</span>, FileStream&gt; fileStreams;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">LoadTables</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        fileStreams = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, FileStream&gt;(Tables.TABLE_COUNT / <span class="number">2</span>);</span><br><span class="line">        tables = <span class="keyword">new</span> cfg.Tables(LoadOffsetByteBuf, ByteBufLoader);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Dispose</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> fs <span class="keyword">in</span> fileStreams.Values)</span><br><span class="line">        &#123;</span><br><span class="line">            fs.Dispose();</span><br><span class="line">        &#125;</span><br><span class="line">        fileStreams.Clear();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> ByteBuf <span class="title">LoadOffsetByteBuf</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">file</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> a = File.ReadAllBytes(<span class="string">$&quot;<span class="subst">&#123;Application.streamingAssetsPath&#125;</span>/Config/offset/<span class="subst">&#123;<span class="keyword">file</span>&#125;</span>.bytes&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ByteBuf(a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注意： 安卓平台和WebGL平台不能读取StreamingAssetsPath下的文件，这里只提供思路，可以根据各自项目情况作出调整</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> ByteBuf <span class="title">ByteBufLoader</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">file</span>, <span class="built_in">int</span> offset, <span class="built_in">int</span> length</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!fileStreams.TryGetValue(<span class="keyword">file</span>, <span class="keyword">out</span> <span class="keyword">var</span> fs))</span><br><span class="line">        &#123;</span><br><span class="line">            fs = <span class="keyword">new</span> FileStream(<span class="string">$&quot;<span class="subst">&#123;Application.streamingAssetsPath&#125;</span>/Config/bin/<span class="subst">&#123;<span class="keyword">file</span>&#125;</span>.bytes&quot;</span>, FileMode.Open);</span><br><span class="line">            fileStreams.Add(<span class="keyword">file</span>, fs);</span><br><span class="line">        &#125;</span><br><span class="line">        fs.Seek(offset, SeekOrigin.Begin);</span><br><span class="line">        fs.Read(BUFFER, <span class="number">0</span>, length);</span><br><span class="line">        <span class="keyword">var</span> buf = <span class="keyword">new</span> ByteBuf(BUFFER, <span class="number">0</span>, length);</span><br><span class="line">        <span class="keyword">return</span> buf;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过<code>ByteBufLoader</code>加载Bytes文件，然后再调用再将加载的<code>ByteBuf</code>数据一一匹配给<code>Tables</code>变量中的变量。</p><p>需要注意的地方是，需要根据文件的位置和项目的加载方式修改<code>ByteBufLoader</code>函数，比如可以换成ab包加载。<code>Tables</code>是luban自动生成的，不要随意修改代码，以免被覆盖。</p></li></ol><h3 id="三、Luban优化教程"><a href="#三、Luban优化教程" class="headerlink" title="三、Luban优化教程"></a>三、Luban优化教程</h3><p>通过学习官方的实例工程，可以发现一个问题，所有的数据都是一次性全部加载的，这并不合理，尤其是既需要游戏初始化时加载一些数据，又有很多大文件，这会造成浪费内存拖慢启动。所以这里给出一个按文件加载的优化方案。这里参考了大佬<a href="https://blog.csdn.net/wankcn">明天不吃鱼</a>的帖子<a href="https://blog.csdn.net/wankcn/article/details/127883528?spm=1001.2014.3001.5502">Unity导表工具Luban插件的数据加载原理与优化</a>。</p><p>这里和大佬不一样的地方有两个，一个是大佬用的是c#+json的方案，博主使用的c#+bin，另一个是博主在大佬的基础上添加了引用解析。核心思路其实很简单，就是修改<code>tables.sbn</code>和和<code>table.sbn</code>模板，使得其继承接口*<code>IVOFun</code>*，通过该接口添加对应数据，并在加载数据时自动进行应用解析。</p><ol><li><p>修改<code>tables.sbn</code>和<code>table.sbn</code>模板</p><p>下图就是默认模板所在的路径和我们需要的文件，文件夹里包含<code>bean.sbn</code>,<code>tables.sbn</code>和<code>table.sbn</code>三个文件，我们只需要后面两个。</p><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202506101505320.png" alt="image-20250610150510252"></p><p>如下图在bat目录下创建文件夹<code>CustomTemplate</code>再创建<code>cs-bin</code>文件夹，然后将默认的<code>tables.sbn</code>和<code>table.sbn</code>丢进去</p><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202506101502672.png" alt="image-20250610150242554"></p><p>大佬关于修改模板的原理已经解释的非常详细了，这里就直接贴出修改后的模板代码，有些许不同可以自行比对。</p><p>首先是<code>tables.sbn</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">using Luban;</span><br><span class="line"></span><br><span class="line">&#123;&#123;namespace_with_grace_begin __namespace&#125;&#125;</span><br><span class="line"></span><br><span class="line">/// &lt;summary&gt;</span><br><span class="line">/// 所有对象继承必须继承该接口</span><br><span class="line">/// 仅在加载数据时调用</span><br><span class="line">/// &lt;summary&gt;</span><br><span class="line">public interface IVOFun</span><br><span class="line">&#123;</span><br><span class="line">void _LoadData(ByteBuf _buf);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// &lt;summary&gt;</span><br><span class="line">/// 用于解析引用关系</span><br><span class="line">/// &lt;summary&gt;</span><br><span class="line">public interface IResolvable</span><br><span class="line">&#123;</span><br><span class="line">    void ResolveRef(Tables tables);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public partial class &#123;&#123;__name&#125;&#125;</span><br><span class="line">&#123;</span><br><span class="line">    &#123;&#123;~for table in __tables ~&#125;&#125;</span><br><span class="line">&#123;&#123;~if table.comment != &#x27;&#x27; ~&#125;&#125;</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// &#123;&#123;escape_comment table.comment&#125;&#125;</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">&#123;&#123;~end~&#125;&#125;</span><br><span class="line">    public &#123;&#123;table.full_name&#125;&#125; &#123;&#123;format_property_name __code_style table.name&#125;&#125; &#123;get; set;&#125;</span><br><span class="line">    &#123;&#123;~end~&#125;&#125;</span><br><span class="line"></span><br><span class="line">    public &#123;&#123;__name&#125;&#125;()&#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;namespace_with_grace_end __namespace&#125;&#125;</span><br></pre></td></tr></table></figure><p>然后是<code>table.sbn</code>，其实只修改了一下构造函数，将构造函数拆分了。</p><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202506101525128.png" alt="image-20250610152553024"></p><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202506101526896.png" alt="image-20250610152625821"></p><p>如上图所示，在末尾添加函数_LoadData</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public void _LoadData(ByteBuf _buf)</span><br><span class="line">    &#123;</span><br><span class="line">        for(int n = _buf.ReadSize() ; n &gt; 0 ; --n)</span><br><span class="line">        &#123;</span><br><span class="line">            &#123;&#123;declaring_type_name value_type&#125;&#125; _v;</span><br><span class="line">            &#123;&#123;deserialize &#x27;_buf&#x27; &#x27;_v&#x27; value_type&#125;&#125;</span><br><span class="line">            _dataList.Add(_v);</span><br><span class="line">            _dataMap.Add(_v.&#123;&#123;format_property_name __code_style __table.index_field.name&#125;&#125;, _v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>最后一步，修改bat代码，在<code>dotnet</code>中添加一句<code>--customTemplateDir %WORKSPACE%\CustomTemplate^</code>，运行即可。</p></li><li><p>修改管理类</p><p>核心就是将原本<code>Table</code>做的事儿交给了这个类来做，变成自己管理一个字典去控制数据，每次取数据前看字典里是否有，没有则去加载，加载后再通过放射去进行一次引用解析，代码如下：</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">readonly</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt; tables = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">GetVOData</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="built_in">string</span> fileName</span>) <span class="keyword">where</span> T : IVOFun, <span class="keyword">new</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (tables.TryGetValue(fileName, <span class="keyword">out</span> <span class="keyword">var</span> cached))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (T)cached;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据自己喜欢的方式获取文件路径</span></span><br><span class="line">    <span class="built_in">string</span> path = <span class="string">$&quot;<span class="subst">&#123;Application.dataPath&#125;</span>/xxx/<span class="subst">&#123;fileName&#125;</span>.bytes&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!File.Exists(path))</span><br><span class="line">    &#123;</span><br><span class="line">        Debug.LogError(<span class="string">$&quot;Config file not found: <span class="subst">&#123;path&#125;</span>&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">default</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> data = <span class="keyword">new</span> T();</span><br><span class="line">    <span class="comment">//这里只是测试，最好换成其他方式，比如异步ab包加载等方式</span></span><br><span class="line">    <span class="keyword">var</span> bytes = File.ReadAllBytes(path);</span><br><span class="line">    data._LoadData(<span class="keyword">new</span> ByteBuf(bytes));</span><br><span class="line">    tables[fileName] = data;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关键点：动态构造 Tables 并自动填充属性</span></span><br><span class="line">    Tables tableContainer = <span class="keyword">new</span> Tables();</span><br><span class="line">    Type tablesType = <span class="keyword">typeof</span>(Tables);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> kv <span class="keyword">in</span> tables)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> key = kv.Key;           <span class="comment">// 比如 &quot;item_tbitem&quot;</span></span><br><span class="line">        <span class="built_in">object</span> <span class="keyword">value</span> = kv.Value;       <span class="comment">// 表对象，比如 TbItem</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> inferredPropName = TryGetTablePropertyName(<span class="keyword">value</span>.GetType());</span><br><span class="line">        <span class="keyword">if</span> (inferredPropName == <span class="literal">null</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        PropertyInfo prop = tablesType.GetProperty(inferredPropName);</span><br><span class="line">        <span class="keyword">if</span> (prop != <span class="literal">null</span> &amp;&amp; prop.CanWrite)</span><br><span class="line">        &#123;</span><br><span class="line">            prop.SetValue(tableContainer, <span class="keyword">value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 自动调用 ResolveRef（如果支持）</span></span><br><span class="line">    <span class="keyword">if</span> (data <span class="keyword">is</span> IResolvable resolvable)</span><br><span class="line">    &#123;</span><br><span class="line">        resolvable.ResolveRef(tableContainer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 找出这个对象在 Tables 中的属性名</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;tableType&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">TryGetTablePropertyName</span>(<span class="params">Type tableType</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 获取类名，比如 TbItem、TbTheme 等</span></span><br><span class="line">    <span class="built_in">string</span> typeName = tableType.Name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 验证它是否存在于 Tables 类型中</span></span><br><span class="line">    <span class="keyword">var</span> tablesType = <span class="keyword">typeof</span>(Tables);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> tablesType.GetProperties())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (prop.PropertyType == tableType || prop.PropertyType.IsAssignableFrom(tableType))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> prop.Name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>额外的优化思路</p><p>这里提供几个博主自己在使用时的思考，</p><ul><li><p>对于小型项目，可以在设计表的时候不涉及互相引用，这样就可以不用管luban里的引用解析，加载了用就完事儿了。这里给一个参考代码</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">GetVOData</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="built_in">string</span> fileName</span>) <span class="keyword">where</span> T : IVOFun, <span class="keyword">new</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (tables.ContainsKey(fileName))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> (T)tables[fileName];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> data = <span class="keyword">new</span> T();</span><br><span class="line">        <span class="comment">//这里只是测试，最好换成其他方式，比如异步ab包加载等方式</span></span><br><span class="line">        <span class="keyword">var</span> a = File.ReadAllBytes(<span class="string">$&quot;<span class="subst">&#123;Application.dataPath&#125;</span>/xxx/<span class="subst">&#123;fileName&#125;</span>.bytes&quot;</span>);</span><br><span class="line">        data._LoadData(<span class="keyword">new</span> ByteBuf(a));</span><br><span class="line">        tables.Add(fileName, data);</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>也可以通过<code>switch-case</code>之类的方法手动控制是否需要添加应用解析，因为博主懒得写就不贴了。</p></li><li><p>强烈建议可以再添加异步加载Bytes文件流的方法。</p></li></ul></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>Unity</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【CodeForces】Round 1016 (Div. 3)记录</title>
    <link href="/2025/05/27/codeforces3/"/>
    <url>/2025/05/27/codeforces3/</url>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://codeforces.com/contest/2093">Codeforces Round 1016 (Div. 3)</a></p><h2 id="A-Ideal-Generator"><a href="#A-Ideal-Generator" class="headerlink" title="A. Ideal Generator"></a>A. Ideal Generator</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505271012644.png" alt="image-20250527101223537"></p><p>输入示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">73</span><br><span class="line">1000</span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">73</span><br><span class="line">1000</span><br></pre></td></tr></table></figure><p>参考代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> t, n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin &gt;&gt; t;</span><br><span class="line"><span class="keyword">while</span> (t--)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line"><span class="keyword">if</span>(n%<span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;No&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Yes&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B-Expensive-Number"><a href="#B-Expensive-Number" class="headerlink" title="B. Expensive Number"></a>B. Expensive Number</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505271130641.png" alt="image-20250527113056592"></p><p>输入示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">666</span><br><span class="line">13700</span><br><span class="line">102030</span><br><span class="line">7</span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">4</span><br><span class="line">3</span><br><span class="line">0</span><br></pre></td></tr></table></figure><p>参考代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> t, n;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin &gt;&gt; t;</span><br><span class="line"><span class="keyword">while</span> (t--)</span><br><span class="line">&#123;</span><br><span class="line">string s;</span><br><span class="line">cin &gt;&gt; s;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="type">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = s.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (s[i] != <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">flag = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (flag)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cout &lt;&lt; s.<span class="built_in">size</span>() - (count + <span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="C-Simple-Repetition"><a href="#C-Simple-Repetition" class="headerlink" title="C. Simple Repetition+"></a>C. Simple Repetition+</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505271423739.png" alt="image-20250527142318679"></p><p>输入示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">52 3</span><br><span class="line">6 7</span><br><span class="line">7 1</span><br><span class="line">1 7</span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NO</span><br><span class="line">NO</span><br><span class="line">YES</span><br><span class="line">NO</span><br></pre></td></tr></table></figure><p>参考代码：</p>]]></content>
    
    
    
    <tags>
      
      <tag>code</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【CodeForces】Round 1020 (Div. 3)记录</title>
    <link href="/2025/05/26/codeforces2/"/>
    <url>/2025/05/26/codeforces2/</url>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://codeforces.com/contest/2106">Codeforces Round 1020 (Div. 3)</a></p><h2 id="A-Dr-TC"><a href="#A-Dr-TC" class="headerlink" title="A. Dr. TC"></a>A. Dr. TC</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505261652878.png" alt="image-20250526165206822"></p><p>输入示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">3</span><br><span class="line">101</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">5</span><br><span class="line">00000</span><br><span class="line">2</span><br><span class="line">11</span><br><span class="line">3</span><br><span class="line">010</span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">3</span><br><span class="line">101</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">5</span><br><span class="line">00000</span><br><span class="line">2</span><br><span class="line">11</span><br><span class="line">3</span><br><span class="line">010</span><br></pre></td></tr></table></figure><p>参考代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> t, n, i, j;</span><br><span class="line">string s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> count;</span><br><span class="line"></span><br><span class="line">cin &gt;&gt; t;</span><br><span class="line"><span class="keyword">while</span> (t &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">t--;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line">cin &gt;&gt; s;</span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span>;</span><br><span class="line">count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; s.<span class="built_in">size</span>(); j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (j == i &amp;&amp; s[i] == <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (j != i &amp;&amp; s[i] == <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; count &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B-St-Chroma"><a href="#B-St-Chroma" class="headerlink" title="B. St. Chroma"></a>B. St. Chroma</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505261649737.png" alt="image-20250526164932686"></p><p>输入示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">7</span><br><span class="line">4 2</span><br><span class="line">4 0</span><br><span class="line">5 0</span><br><span class="line">1 1</span><br><span class="line">3 3</span><br><span class="line">1 0</span><br><span class="line">4 3</span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1 0 3 2</span><br><span class="line">2 3 1 0</span><br><span class="line">3 2 4 1 0</span><br><span class="line">0</span><br><span class="line">0 2 1</span><br><span class="line">0</span><br><span class="line">1 2 0 3</span><br></pre></td></tr></table></figure><p>参考代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, t, y, x;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin &gt;&gt; t;</span><br><span class="line"><span class="keyword">while</span> (t--)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; y &gt;&gt; x;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; y; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (i != x)</span><br><span class="line">cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (y != x)</span><br><span class="line">cout &lt;&lt; x;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="C-Cherry-Bomb"><a href="#C-Cherry-Bomb" class="headerlink" title="C. Cherry Bomb"></a>C. Cherry Bomb</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505261652259.png" alt="image-20250526165249203"></p><p>示例输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">7</span><br><span class="line">3 10</span><br><span class="line">1 3 2</span><br><span class="line">-1 -1 1</span><br><span class="line">5 1</span><br><span class="line">0 1 0 0 1</span><br><span class="line">-1 0 1 0 -1</span><br><span class="line">5 1</span><br><span class="line">0 1 0 0 1</span><br><span class="line">-1 1 -1 1 -1</span><br><span class="line">5 10</span><br><span class="line">1 3 2 5 4</span><br><span class="line">-1 -1 -1 -1 -1</span><br><span class="line">5 4</span><br><span class="line">1 3 2 1 3</span><br><span class="line">1 -1 -1 1 -1</span><br><span class="line">5 4</span><br><span class="line">1 3 2 1 3</span><br><span class="line">2 -1 -1 2 0</span><br><span class="line">5 5</span><br><span class="line">5 0 5 4 3</span><br><span class="line">5 -1 -1 -1 -1</span><br></pre></td></tr></table></figure><p>示例输出：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">0</span><br><span class="line">0</span><br><span class="line">7</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">0</span><br></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>code</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【CodeForces】Round 1017 (Div. 4)记录</title>
    <link href="/2025/05/23/codeforces1/"/>
    <url>/2025/05/23/codeforces1/</url>
    
    <content type="html"><![CDATA[<p>题目链接：<a href="https://codeforces.com/contest/2094">Codeforces Round 1017 (Div. 4)</a></p><h2 id="A-Trippi-Troppi"><a href="#A-Trippi-Troppi" class="headerlink" title="A. Trippi Troppi"></a>A. Trippi Troppi</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505231822090.png" alt="image-20250523182202040"></p><p>输入示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">7</span><br><span class="line">united states america</span><br><span class="line">oh my god</span><br><span class="line">i cant lie</span><br><span class="line">binary indexed tree</span><br><span class="line">believe in yourself</span><br><span class="line">skibidi slay sigma</span><br><span class="line">god bless america</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">usa</span><br><span class="line">omg</span><br><span class="line">icl</span><br><span class="line">bit</span><br><span class="line">biy</span><br><span class="line">sss</span><br><span class="line">gba</span><br></pre></td></tr></table></figure><p>参考代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">string ans[<span class="number">10000</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">PrientAns</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; ans[i] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line"><span class="type">int</span> count = <span class="number">0</span>,index = <span class="number">0</span>;</span><br><span class="line">string tempAns;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n * <span class="number">3</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">string tempStr;</span><br><span class="line">cin &gt;&gt; tempStr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (count &lt; <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">tempAns += tempStr[<span class="number">0</span>];</span><br><span class="line">count++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (count == <span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">tempAns += tempStr[<span class="number">0</span>];</span><br><span class="line">ans[index] = tempAns;</span><br><span class="line">tempAns.<span class="built_in">clear</span>();</span><br><span class="line">index++;</span><br><span class="line">count = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">PrientAns</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B-Bobritto-Bandito"><a href="#B-Bobritto-Bandito" class="headerlink" title="B. Bobritto Bandito"></a>B. Bobritto Bandito</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505231819794.png" alt="image-20250523181952687"></p><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505231821046.png" alt="image-20250523182119998"></p><p>输入示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">4 2 -2 2</span><br><span class="line">4 1 0 4</span><br><span class="line">3 3 -1 2</span><br><span class="line">9 8 -6 3</span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-1 1</span><br><span class="line">0 1</span><br><span class="line">-1 2</span><br><span class="line">-5 3</span><br></pre></td></tr></table></figure><p>题目解析：把题目结构一下就行了，输入的是m、n、l、r，分别对应总天数、目标天数、总天数下的左区间和总天数下的右区间。其实根本不需要这么多参数，两个就行了，一个是n目标天数，一个是l，因为一定包含0而l和r的间隔一定等于m，所以知道l就能知道l和r，然后再选一个间隔为n且在l和r区间内的数作为答案即可。</p><p>参考代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits/stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int n;</span><br><span class="line">int days[2000], offsetDay[2000];</span><br><span class="line">//string ansLeft[2000], ansRight[2000];</span><br><span class="line"></span><br><span class="line">void PrientAns()</span><br><span class="line">&#123;</span><br><span class="line">for (int i = 0; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">int left = 0, right = 0;</span><br><span class="line"></span><br><span class="line">if (offsetDay[i] == 0)</span><br><span class="line">&#123;</span><br><span class="line">//没有偏移</span><br><span class="line">left = 0; </span><br><span class="line">right = days[i];</span><br><span class="line">&#125;</span><br><span class="line">else if (-offsetDay[i] &gt;= days[i])</span><br><span class="line">&#123;</span><br><span class="line">//偏移量大于目标天数，可以所有感染向左</span><br><span class="line">left = -days[i]; </span><br><span class="line">right = 0;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">//偏移量小于目标天数，感染需要向右分布部分</span><br><span class="line">left = offsetDay[i];</span><br><span class="line">right = days[i] + offsetDay[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; left &lt;&lt; &quot; &quot; &lt;&lt; right &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line">int count = 0, index = 0;</span><br><span class="line">int tempNum;</span><br><span class="line"></span><br><span class="line">for (int i = 0; i &lt; n * 4; i++)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; tempNum;</span><br><span class="line"></span><br><span class="line">if (count == 0)</span><br><span class="line">&#123;</span><br><span class="line">count++;</span><br><span class="line">&#125;</span><br><span class="line">else if (count == 1)</span><br><span class="line">&#123;</span><br><span class="line">days[index] = tempNum;</span><br><span class="line">count++;</span><br><span class="line">&#125;</span><br><span class="line">else if (count == 2)</span><br><span class="line">&#123;</span><br><span class="line">offsetDay[index] = tempNum;</span><br><span class="line">count++;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">count = 0;</span><br><span class="line">index++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PrientAns();</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="C-Brr-Brrr-Patapim"><a href="#C-Brr-Brrr-Patapim" class="headerlink" title="C. Brr Brrr Patapim"></a>C. Brr Brrr Patapim</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505261146964.png" alt="image-20250526114635836"></p><p>输入示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3</span><br><span class="line">1 6 2</span><br><span class="line">6 2 4</span><br><span class="line">2 4 3</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">2 3</span><br><span class="line">3 4</span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">5 1 6 2 4 3 </span><br><span class="line">2 1 </span><br><span class="line">1 2 3 4 </span><br></pre></td></tr></table></figure><p>参考代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> t, n, g[<span class="number">1601</span>][<span class="number">1601</span>], j, i, x[<span class="number">1601</span>], h[<span class="number">1601</span>], p;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin &gt;&gt; t;</span><br><span class="line"><span class="keyword">while</span> (t &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">t--;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; g[i][j];</span><br><span class="line">x[i + j] = g[i][j];</span><br><span class="line">h[g[i][j]]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (p = <span class="number">1</span>; p &lt;= <span class="number">2</span> * n; p++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (h[p] == <span class="number">0</span>)</span><br><span class="line">x[<span class="number">1</span>] = p;</span><br><span class="line">h[p] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (p = <span class="number">1</span>; p &lt;= <span class="number">2</span> * n; p++)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; x[p] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D-Tung-Tung-Sahur"><a href="#D-Tung-Tung-Sahur" class="headerlink" title="D. Tung Tung Sahur"></a>D. Tung Tung Sahur</h2><p><img src="https://blogimage01.oss-cn-chengdu.aliyuncs.com/img/202505261424373.png" alt="image-20250526142447276"></p><p>输入示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">R</span><br><span class="line">RR</span><br><span class="line">LRLR</span><br><span class="line">LRLR</span><br><span class="line">LR</span><br><span class="line">LLLR</span><br><span class="line">LLLLLRL</span><br><span class="line">LLLLRRLL</span><br><span class="line">LLRLRLRRL</span><br><span class="line">LLLRLRRLLRRRL</span><br></pre></td></tr></table></figure><p>输出示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">YES</span><br><span class="line">YES</span><br><span class="line">NO</span><br><span class="line">NO</span><br><span class="line">YES</span><br></pre></td></tr></table></figure><p>题目解析：如果按照递归模拟的思路去做时间复杂度应该过不了，就不考虑这个办法了。这里参考了用另一种思路，先定义输入的字符串为s1和s2，s1，我们以示例中的第四个输入为例子，LLLLLRL为s1，以LLLLRRLL为s2，需要将s1和s2按照L和R分割，将s1分割成LLLLL、R、L，分别为x、y、z，将s2分割成LLLL、RR、LL，这三段分别为，a、b、c。如果a和x的关系为<code>a &gt;= x &amp;&amp; a &lt;= x * 2</code>则对b和y判断，全部通过则为yes，否则为no。 </p><p>参考代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> t, n;</span><br><span class="line">string s1, s2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin &gt;&gt; t;</span><br><span class="line"><span class="keyword">while</span> (t--)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; s1;</span><br><span class="line">cin &gt;&gt; s2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (s<span class="number">1.</span><span class="built_in">size</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> pos = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (pos &lt; s<span class="number">1.</span><span class="built_in">size</span>() &amp;&amp; s1[pos] == s1[pos + <span class="number">1</span>])</span><br><span class="line">&#123;</span><br><span class="line">pos++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> num = pos + <span class="number">1</span>;</span><br><span class="line"><span class="type">char</span> c = s1[pos];</span><br><span class="line"><span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (k &lt; s<span class="number">2.</span><span class="built_in">size</span>() &amp;&amp; s2[k] == c)</span><br><span class="line">&#123;</span><br><span class="line">k++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (k &gt;= num &amp;&amp; k &lt;= <span class="number">2</span> * num)</span><br><span class="line">&#123;</span><br><span class="line">s<span class="number">2.</span><span class="built_in">erase</span>(<span class="number">0</span>, k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">s<span class="number">1.</span><span class="built_in">erase</span>(<span class="number">0</span>, num);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!s<span class="number">1.</span><span class="built_in">size</span>() &amp;&amp; !s<span class="number">2.</span><span class="built_in">size</span>())</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>code</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【读书笔记】《Unity3D高级编程: 主程手记》02：常用的优化方式</title>
    <link href="/2025/05/22/unityLearn2/"/>
    <url>/2025/05/22/unityLearn2/</url>
    
    <content type="html"><![CDATA[<p>​本文是<a href="https://book.douban.com/subject/35732244/">《Unity3D高级编程: 主程手记》</a>的读书笔记（后面统一简称主程手记），主程手记是一本很全面的Unity进阶的书记，值得所有Unity开发都买一本读一读。博主这里将一些自己经常用得上的内容重新做了遍归纳总结，做成读书笔记也方便自己查阅。</p><h2 id="1-List和Dictionary的优化方式"><a href="#1-List和Dictionary的优化方式" class="headerlink" title="1. List和Dictionary的优化方式"></a>1. List和Dictionary的优化方式</h2><p>​List本质就是数组，Dictionary的本质是两个数组，一个数组报错索引，一个数组保存数据。</p><p>​对于List，在创建时可以预估数量给予一个默认长度，能很好节约内存和GC。</p><p>​对于Dictionary，必须要考虑哈希碰撞的问题，数组越大，哈希碰撞得概率就很小。所以在实际使用时，Key用值类型更好，也可以根据预估数量给予一个默认长度。GetHashCode()也是比较隐形的性能消耗。</p><h2 id="2-字符串问题"><a href="#2-字符串问题" class="headerlink" title="2. 字符串问题"></a>2. 字符串问题</h2><p>​在看主程手记这本书前，博主一直不知道字符串如此离谱，字符串的运用就跟吃饭喝水一样寻常，代价就是字符串也像吃饭喝水一样疯狂吃内存。主要原因就是，C#语言中，字符串没有任何缓存机制，每次都需要重新分配string内存。这里有三种办法：</p><ol><li><p>自建缓存机制。</p><p>原书中提出可以用Dictionary缓存一些标志性的字符串，每次使用时先查询字典，有则使用，没有则将其加入字典。</p></li><li><p>使用native方法。</p><p>是类似于C++的指针的方法来处理string类，书里给出了参考代码，这里不做赘述。</p></li><li><p>使用开源的第三方插件</p><p>这里有两个开源插件<a href="https://github.com/871041532/zstring">zstring</a>和<a href="https://github.com/Cysharp/ZString">ZString</a>，两者都能有效降低字符串拼接时的GC。</p></li></ol><h2 id="3-善用struct"><a href="#3-善用struct" class="headerlink" title="3. 善用struct"></a>3. 善用struct</h2><p>​从未想过<code>struct</code>如此美妙，因为<code>struct</code>是值类型，在赋值时是数据的拷贝，每个变量有独立的存储空间。因为<code>struct</code>的内存分配在栈上而且是连续的，所以分配和释放都很快，善用<code>struct</code>能很好的提升CPU的缓存命中率。这里有些使用技巧的总结：</p><ul><li>适用于数据量小的情况。</li><li>适用于频繁创建和销毁的场景中。</li></ul><h2 id="4-协程"><a href="#4-协程" class="headerlink" title="4. 协程"></a>4. 协程</h2><p>​协程是Unity中特殊的用法，其作用是能够在程序执行过程中暂停或恢复方法，达到类似多线程的效果，但是其本质还是主线程之中。携程的基本用法这里省略掉，着重写一下协程的问题和优化。</p><p>​协程会产生CG，尤其是创建和停止时，会创建大量的临时对象，增加GC负担，优化协程的方法很简单，<strong>不用协程</strong>就可以了，使用UniTask即可。</p><h2 id="5-对象池"><a href="#5-对象池" class="headerlink" title="5. 对象池"></a>5. 对象池</h2><p>​尽可能的使用对象池，这样可以减少内存池分配的次数和内存碎片，还能避免内存卸载带来的性能消耗。书中给出了实例代码，这里挖个坑后续补上自己的代码。</p>]]></content>
    
    
    
    <tags>
      
      <tag>Unity</tag>
      
      <tag>C#</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【读书笔记】《Unity3D高级编程: 主程手记》01：C#技术总结</title>
    <link href="/2025/05/21/unityLearn1/"/>
    <url>/2025/05/21/unityLearn1/</url>
    
    <content type="html"><![CDATA[<p>​本文是<a href="https://book.douban.com/subject/35732244/">《Unity3D高级编程: 主程手记》</a>的读书笔记（后面统一简称主程手记），主程手记是一本很全面的Unity进阶的书记，值得所有Unity开发都买一本读一读。博主这里将一些自己经常用得上的内容重新做了遍归纳总结，做成读书笔记也方便自己查阅。</p><h2 id="1-List的要点"><a href="#1-List的要点" class="headerlink" title="1. List的要点"></a>1. List的要点</h2><p>​原书将List的源码逐个功能进行了分析，这里就不重复引用了，直接附上<a href="https://referencesource.microsoft.com/#mscorlib/system/collections/generic/list.cs">源码</a>。List的要点如果用一句话总结那就是：<strong>List是由数组实现的，而不链表</strong>。也是因为底层逻辑是数组的原因，List的效率并不高。</p><ul><li><p>Add、Insert: 这两个方法的本质还是数组拷贝，List的扩容是最需要注意的地方，假如创建一个空的List，默认容量为0，在Add或者Insert元素时，会先检查容量是否足够，不足则进行2的指数级别扩容，比如2、4、8、16、32…依次扩容。<strong>所以在创建List的时候分配一个预计的默认容量能减少GC的压力，也避免浪费内存</strong>。</p></li><li><p>Remove: 同上，本质还是数组拷贝。</p></li><li><p>Contains: 使用了线性查找的方式比较元素，效率为O(n)。</p></li><li><p>Find: 同上。</p></li><li><p>Enumerator: 原书表示foreach会增加Enumerator实例，造成GC压力，在 .NET4.0以后修复了此问题。</p></li><li><p>Sort: 使用的是快速排序，效率为O(nLgn)。</p></li></ul><h2 id="2-Dictionary的要点"><a href="#2-Dictionary的要点" class="headerlink" title="2. Dictionary的要点"></a>2. Dictionary的要点</h2><p>​原书讲Dictionary解析的很好，这里博主自己做一些总结。Dictionary是Key和Value一一映射的字典型数据结构，对于Key，DIctionary做的是加入容器时对Key做Hash运算。在源码中，哈希冲突才拉链法贯穿了整个底层架构，<strong>在使用Dictionary时要尽量避免Key的Hash冲突</strong>。</p><ul><li>Add、Insert: Add和Insert的扩容方式为初始化时为0，自动扩容按照3、7、17、37的方式扩容，所以和List相同，<strong>初始化的时候给定一个大致的数量更有效率</strong>。</li><li>Remove: Remove并不会删减内存。</li><li>ContainsKey: 本质是用Key值得到哈希地址开始查询，<strong>用数值的方式做Key更有效率</strong>。</li></ul><h2 id="3-装箱、拆箱"><a href="#3-装箱、拆箱" class="headerlink" title="3. 装箱、拆箱"></a>3. 装箱、拆箱</h2><blockquote><p>C#中有引用类型（Reference Type）和值类型（Value Type)</p><p>值类型：常见的有<code>int</code>、<code>float</code>、<code>bool</code>、<code>char</code> 、<code>struct</code>、<code>enum</code> 等）。值类型数据在栈（stack）上分配内存空间。当一个值类型变量在赋值另一个变量时，时会进行数据的复制，两个变量都会有独立的内存空间和数据副本，修改一个不会影响另一个。</p><p>引用类型：常见的引用类型包括（<code>class</code>、<code>interface</code>、<code>array</code>、<code>delegate</code>）等，引用类型在堆（heap）上分配内存。当一个引用类型的变量赋值给另一个变量时，将复制内存地址的引用而不是值，所以两个变量指向同一个内存地址，修改一个变量会影响所有引用该数据的变量。</p></blockquote><p>​装箱就是把值类型实列转换为引用类型，拆箱正好相反。下面用代码分别展示一下装箱和拆箱。</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">object</span> obj = a;  <span class="comment">// 装箱操作，a 的值被复制到堆上，obj 指向该堆内存地址</span></span><br></pre></td></tr></table></figure><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">object</span> obj = a; <span class="comment">// 装箱</span></span><br><span class="line"><span class="built_in">int</span> b = (<span class="built_in">int</span>)obj; <span class="comment">// 拆箱，将堆上的数据复制回值类型变量 b</span></span><br></pre></td></tr></table></figure><p>​在Unity中一般只有当接口需要更加通用的时候才会需要装箱，比如一个接口参数为object，这样就支持传入任意类型。但是<strong>装箱、拆箱会消耗CPU产生内存碎片</strong>，原书中提到三种方法可以优化，分别是：</p><ol><li>Struct 通过重载函数来避免拆箱、装箱。</li><li>通过泛型来避免拆箱、装箱。</li><li>通过继承统一的接口提前拆箱、装箱，避免多次重复拆箱、装箱。</li></ol><h2 id="5-浮点数"><a href="#5-浮点数" class="headerlink" title="5. 浮点数"></a>5. 浮点数</h2><p>​浮点数也是一个老生常谈的问题了，浮点数用起来比较矛盾，可以说是<strong>既精确又不精确</strong>，一方面能保证一定的精度，另一方面呢又不能拿去比较（有些新手用&#x3D;&#x3D;比较，这不就寄了嘛），每次计算结果又不同。通过学习主程手记，总结了浮点数的特征，同时学习到几种浮点数的替代用法，很有价值。</p><ul><li><p>浮点数的特征： float为4字节（32位），范围为-3.4×10³⁸ 到 +3.4×10³⁸ 。double为8字节（64位），范围为-1.7×10³⁰⁸ 到 +1.7×10³⁰⁸。浮点数有三个重要特征：数值比较不相等；数值计算不确定；不同设备计算结果不同。</p></li><li><p>几种浮点数的优化方法：</p><ul><li>方法一：用int或long替代浮点数，比如将9.9乘以1000变成99000，这样就能保证3位的精度了，实际使用要注意int和long的精度上限问题。</li><li>方法二：用定点数保持一致性并缩小精度问题，所谓的定点数，就是将浮点数的整数位和小数位拆开操作，可以尝试在unity中自己封装。</li><li>方法三：用字符串代替浮点数，CPU和内存性能消耗都大，需要高精度的时候可以考虑。</li></ul></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Unity</tag>
      
      <tag>C#</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/05/21/hello-world/"/>
    <url>/2025/05/21/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
